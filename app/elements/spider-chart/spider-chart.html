<dom-module id="spider-chart">
<style>
	:host {
		height: 100%;
		@apply(--layout);
		@apply(--layout-vertical);
		padding: 20px;
	}
	:host.blurred {
		-webkit-filter: blur(2px);
		-moz-filter: blur(2px);
		-ms-filter: blur(2px);
		-o-filter: blur(2px);
		filter: blur(2px);
	}
	h1.header {
		@apply(--header);
		text-align: center;
		padding: 15px 0;
	}
	h2.subtitle {
		@apply(--subtitle);
	}
	#spider {
		height: 600px;
		width: 100%;
		flex: 4;
	}
/*	.info {
		flex: 1;
		border: 1px solid #F7A017;
	}*/
/*	.descs {
		flex: 1;
		color: white;
		font-size: 16px;
		line-height: 1.6;
		width: 500px;
	}*/

	.info {
		@apply(--layout-vertical);
		border: 1px solid #4D4D4D;
		flex: 1;
		margin: 20px;
	}
	.top {
		background-color: #222222;
		border-bottom: 1px solid #4D4D4D;
	}
	.title {
		@apply(--layout-horizontal);
		@apply(--layout-flex);
	}
	.descs {
		padding: 20px;
		@apply(--layout-vertical);
	}
	.descs p {
		color: white;
		padding: 10px;
		line-height: 1.7;
		margin: 0;
	}
</style>
<template>
	<h1 class="header">Strength Your Skills</h1>
	<div class="layout horizontal">
		<div id="spider"></div>
		<div class="info">
			<div class="layout horizontal top">
				<paper-tabs selected="{{selected}}">
					<paper-tab>Metabolic Fitness</paper-tab>
					<paper-tab>Muscle Power</paper-tab>
					<paper-tab>Muscle Endurance</paper-tab>
				</paper-tabs>
			</div>
			<div class="descs">
				<iron-pages selected="{{selected}}" attr-for-selected="data-page">
					<section data-page="0">
						<p>Fatigue (also called exhaustion, tiredness, languidness, languor, lassitude, and listlessness) is a subjective feeling of tiredness which is distinct from weakness, and has a gradual onset. Unlike weakness, fatigue can be alleviated by periods of rest. Fatigue can have physical or mental causes. Physical fatigue is the transient inability of a muscle to maintain optimal physical performance, and is made more severe by intense physical exercise.</p>
					</section>
					<section data-page="1">
						<p>Muscle is a soft tissue found in most animals. Muscle cells contain protein filaments of actin and myosin that slide past one another, producing a contraction that changes both the length and the shape of the cell. Muscles function to produce force and motion. They are primarily responsible for maintaining and changing posture, locomotion, as well as movement of internal organs, such as the contraction of the heart and the movement of food through the digestive system via peristalsis.</p>
					</section>
					<section data-page="2">
						<p>In physics, power is the rate of doing work. It is the amount of energy consumed per unit time. Having no direction, it is a scalar quantity. In the SI system, the unit of power is the joule per second (J/s), known as the watt in honour of James Watt, the eighteenth-century developer of the steam engine.</p>
					</section>
				</iron-pages>
			</div>
		</div>
	</div>
	<div class="layout horizontal flex hidden">
		<h1>Last <span>{{timeRange}}</span> weeks</h1>
		<paper-slider id="dateSelection" pin="" max="24" step="1" value="10"></paper-slider>
	</div>
</template>
<script>
Polymer({
	is: 'spider-chart',
	ready: function () {
		if (!featureManagement.hasFeatures) {
			return;
		}
		this.chart = null;
		this.selected = 0;

		this.makeData();
		this.title = this.spiders.fatigue.title;
		this.desc = this.spiders.fatigue.desc;

		this.mapping = {
			metobolic_fitness: 'Metabolic Fitness',
			muscle_endurance: 'Muscle Endurance',
			muscle_power: 'Muscle Power'
		};

		this.chartData = [];

		var path = '/b/api/v1/users/runnerprofile?srtDate=02-01-2017&endDate=04-01-2017';
		if (isLocal) {
			path = '/powercenter/scripts/spider.json';
		}
		superagent
			.get(path)
			.send()
			.set('Accept', 'application/json')
			.set('Authorization', `Bearer: ${jwt.token}`)
			.end((err, res) => {
				if (res.ok) {
					this.data = res.body;
					this.processData();
					this.createChart();
				} else {
					console.log('Error: cannot fetch data');
				}
			});
	},
	processData: function () {
		for (var key of Object.keys(this.data)) {
			this.chartData.push({
				category: this.mapping[key],
				units: Math.floor(this.data[key] * 100)
			});
		}
	},
	createChart: function () {
		this.chart = AmCharts.makeChart(
			this.$.spider,
			{
				type: 'radar',
				theme: 'stryd',
				valueAxes: [{
					axisTitle: 40,
					minimum: 0,
					maximum: 100,
					axisAlpha: 1,
					dashLength: 0,
					labelsEnabled: false,
					fontSize: 18,
					id: 'pts'
				}],
				colors: ['#F5A214'],
				startDuration: 2,
				graphs: [{
					balloonText: '[[value]] points',
					bullet: 'round',
					bulletSize: 30,
					lineThickness: 10,
					valueField: 'units'
				}],
				categoryField: 'category',
				dataProvider: this.chartData
			}
		);
		// this.chart.addListener('clickGraph', (e) => {
		// 	console.log(e);
		// });
		// this.chart.addListener('clickGraphItem', (e) => {
		// 	console.log(e);
		// });
		// console.log(this.chart.getValueAxisById('pts'));
		// this.chart.getValueAxisById('pts').addListener('clickGuide', (e) => {
		// 	console.log(e);
		// });
	},
	makeData: function () {
		this.spiders = {
			fatigue: {
				title: 'Fatigue',
				desc: 'Fatigue (also called exhaustion, tiredness, languidness, languor, lassitude, and listlessness) is a subjective feeling of tiredness which is distinct from weakness, and has a gradual onset. Unlike weakness, fatigue can be alleviated by periods of rest. Fatigue can have physical or mental causes. Physical fatigue is the transient inability of a muscle to maintain optimal physical performance, and is made more severe by intense physical exercise.'
			},
			muscle: {
				title: 'Muscle Condition',
				desc: 'Muscle is a soft tissue found in most animals. Muscle cells contain protein filaments of actin and myosin that slide past one another, producing a contraction that changes both the length and the shape of the cell. Muscles function to produce force and motion. They are primarily responsible for maintaining and changing posture, locomotion, as well as movement of internal organs, such as the contraction of the heart and the movement of food through the digestive system via peristalsis.'
			},
			power: {
				title: 'Power Rank',
				desc: 'In physics, power is the rate of doing work. It is the amount of energy consumed per unit time. Having no direction, it is a scalar quantity. In the SI system, the unit of power is the joule per second (J/s), known as the watt in honour of James Watt, the eighteenth-century developer of the steam engine.'
			},
			endurance: {
				title: 'Endurance',
				desc: 'Endurance (also related to sufferance, resilience, constitution, fortitude, and hardiness) is the ability of an organism to exert itself and remain active for a long period of time, as well as its ability to resist, withstand, recover from, and have immunity to trauma, wounds, or fatigue. It is usually used in aerobic or anaerobic exercise. The definition of long varies according to the type of exertion â€“ minutes for high intensity anaerobic exercise, hours or days for low intensity aerobic exercise. Training for endurance can have a negative impact on the ability to exert strength[1] unless an individual also undertakes resistance training to counteract this effect.'
			}
		};
	}
});
</script>
</dom-module>